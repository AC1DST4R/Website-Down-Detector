<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Down Detector</title>
<style>
    body { font-family: Arial, sans-serif; background: #1e1e1e; color: #f0f0f0; padding: 20px; }
    h1 { text-align: center; margin-bottom: 30px; }
    .account-holder { border: 1px solid #444; padding: 15px; margin-bottom: 20px; border-radius: 12px; text-align: center; }
    .project { border: 1px solid #444; padding: 15px; margin: 10px 0; border-radius: 12px; }
    .project h2 { margin: 0 0 15px; }
    a { color: #4ea1f3; text-decoration: none; }
    .link-label { font-weight: bold; margin-right: 5px; }
    .status {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 60px;
        height: 30px;
        padding: 0 12px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 14px;
        margin-left: 10px;
        color: #fff;
        position: relative;
    }
    .up { background-color: #0f0; }
    .down { background-color: #f00; }
    .status::before {
        content: attr(data-arrow);
        display: inline-flex;
        width: 16px;
        height: 16px;
        margin-right: 6px;
        border-radius: 50%;
        background: rgba(255,255,255,0.2);
        align-items: center;
        justify-content: center;
        font-size: 12px;
        animation: pulse 1s infinite;
    }
    @keyframes pulse {
        0% { transform: scale(1); opacity: 0.6; }
        50% { transform: scale(1.3); opacity: 1; }
        100% { transform: scale(1); opacity: 0.6; }
    }
</style>
</head>
<body>

<h1>Down Detector</h1>

<div class="account-holder">
    <h2>Account Holder</h2>
    <p><a href="https://github.com/AC1DST4R" target="_blank">https://github.com/AC1DST4R</a></p>
</div>

<div id="projects"></div>

<script>
// ===== Helper =====
function safeId(str) {
    return str.toLowerCase().replace(/[^a-z0-9]/g, '-');
}

// ===== List of projects (for display) =====
const projectsList = [
    "Apps",
    "Web Ports",
    "Minecraft Port",
    "C00lGUI",
    "FATED",
    "Service Hour Tracker",
    "Code Sandbox",
    "Audio Visualizer",
    "Webhookd",
    "Note Summarizer"
];

const container = document.getElementById("projects");

// ===== Create HTML skeleton =====
projectsList.forEach(name => {
    const id = safeId(name);
    const div = document.createElement("div");
    div.className = "project";
    div.innerHTML = `
        <h2>${name}</h2>
        <p>
            <span class="link-label">Repository:</span>
            <a href="https://github.com/AC1DST4R/${name.replace(/\s+/g, '-')}" target="_blank">https://github.com/AC1DST4R/${name.replace(/\s+/g, '-')}</a>
            <span class="status" id="${id}-repo" data-arrow="^">Checking...</span>
        </p>
        <p>
            <span class="link-label">Website:</span>
            <a href="https://ac1dst4r.github.io/${name.replace(/\s+/g, '-')}/" target="_blank">https://ac1dst4r.github.io/${name.replace(/\s+/g, '-')}/</a>
            <span class="status" id="${id}-website" data-arrow="^">Checking...</span>
        </p>
    `;
    container.appendChild(div);
});

// ===== Fetch status.json and update UI =====
async function updateStatus() {
    try {
        const res = await fetch('public/status.json', { cache: "no-store" });
        const data = await res.json();

        data.projects.forEach(p => {
            const id = safeId(p.name);

            // Update repo status
            const repoEl = document.getElementById(`${id}-repo`);
            if (repoEl) {
                repoEl.textContent = p.status;
                repoEl.dataset.arrow = p.status === "Up" ? "^" : "v";
                repoEl.className = `status ${p.status === "Up" ? 'up' : 'down'}`;
            }

            // Update website status
            const webEl = document.getElementById(`${id}-website`);
            if (webEl) {
                webEl.textContent = p.status;
                webEl.dataset.arrow = p.status === "Up" ? "^" : "v";
                webEl.className = `status ${p.status === "Up" ? 'up' : 'down'}`;
            }
        });
    } catch (e) {
        console.error("Failed to fetch status.json", e);
    }
}

// Initial update
updateStatus();

// Refresh every 30 seconds
setInterval(updateStatus, 30000);
</script>

</body>
</html>
